# 项目架构整理说明

## 📅 整理时间
2025年10月8日

## 🎯 整理目的

原先的项目结构存在问题：
1. Git 仓库在 `secure-chat-system/` 目录下
2. 但大量项目文件散落在外层 `secureChat/` 目录
3. 导致这些文件不在版本控制中，项目结构混乱

## 📋 整理内容

### 1. 目录结构调整

#### 创建新目录
- ✅ `scripts/` - 存放所有工具脚本
- ✅ `docs/` - 存放所有文档文件
- ✅ `docs/fixes/` - 存放修复记录文档

#### 文件移动

**脚本文件** → `scripts/`
- `start-system.sh`
- `stop-system.sh`
- `test-chat-system.js`
- `verify-encryption.js`

**文档文件** → `docs/`
- `README.md`
- `USAGE_GUIDE.md`
- `PROJECT_PLAN.md`

**修复记录** → `docs/fixes/`
- `修复文件清单.md`
- `密钥初始化问题修复说明.md`
- `测试修复.md`
- `问题修复总结.md`

#### 清理内容
- ✅ 删除外层 `node_modules/`
- ✅ 删除外层 `package.json` 和 `package-lock.json`
- ✅ 移动 PID 文件到项目根目录

### 2. 脚本路径更新

#### `start-system.sh` 更新
- 依赖检查路径：`secure-chat-system/server` → `../server`
- 依赖检查路径：`secure-chat-system/client` → `../client`
- 启动服务器路径：`cd secure-chat-system/server` → `cd ../server`
- 启动客户端路径：`cd secure-chat-system/client` → `cd ../client`
- PID 文件路径：`.server.pid` → `../.server.pid`
- 文档引用路径：更新为 `docs/` 和 `scripts/` 目录

#### `stop-system.sh` 更新
- PID 文件读取：`.server.pid` → `../.server.pid`
- PID 文件读取：`.client.pid` → `../.client.pid`
- 启动命令提示：`./start-system.sh` → `./scripts/start-system.sh`

### 3. Git 配置更新

#### `.gitignore` 补充
```gitignore
# PID 文件
.server.pid
.client.pid
*.pid
```

### 4. 新增文件

#### 启动入口脚本
- ✅ `start.sh` - 项目根目录启动入口
- ✅ `stop.sh` - 项目根目录停止入口

#### 文档文件
- ✅ `README.md` - 全新的项目主文档
- ✅ `PROJECT_STRUCTURE.md` - 项目结构说明
- ✅ `docs/架构整理说明.md` - 本文档

## 📁 整理后的结构

```
secure-chat-system/                    # Git 仓库根目录
├── client/                           # 前端应用
│   ├── public/
│   ├── src/
│   ├── package.json
│   └── README.md
│
├── server/                           # 后端服务器
│   ├── server.js
│   ├── db.js
│   ├── package.json
│   └── database.db
│
├── scripts/                          # ✨ 新增：工具脚本目录
│   ├── start-system.sh              # 启动脚本
│   ├── stop-system.sh               # 停止脚本
│   ├── test-chat-system.js          # 测试脚本
│   └── verify-encryption.js         # 验证脚本
│
├── docs/                             # ✨ 新增：文档目录
│   ├── README.md                     # 详细文档
│   ├── USAGE_GUIDE.md               # 使用指南
│   ├── PROJECT_PLAN.md              # 项目计划
│   ├── 架构整理说明.md               # 本文档
│   └── fixes/                        # 修复记录
│       ├── 修复文件清单.md
│       ├── 密钥初始化问题修复说明.md
│       ├── 测试修复.md
│       └── 问题修复总结.md
│
├── .git/                             # Git 版本控制
├── .gitignore                        # Git 忽略配置
├── .server.pid                       # 服务器进程ID（运行时）
├── .client.pid                       # 客户端进程ID（运行时）
├── package.json                      # 根项目依赖
├── node_modules/                     # 根项目依赖包
├── README.md                         # ✨ 新增：项目主文档
├── PROJECT_STRUCTURE.md              # ✨ 新增：结构说明
├── start.sh                          # ✨ 新增：启动入口
└── stop.sh                           # ✨ 新增：停止入口
```

## 🚀 使用方式变化

### 之前（外层目录）
```bash
cd /home/lyanta/secureChat
./start-system.sh           # 从外层启动
node test-chat-system.js    # 从外层测试
```

### 现在（项目根目录）
```bash
cd /home/lyanta/secureChat/secure-chat-system
./start.sh                           # 快捷启动
# 或
./scripts/start-system.sh            # 完整路径

node scripts/test-chat-system.js     # 运行测试
```

## ✅ 整理收益

### 1. 版本控制完整
- ✅ 所有项目文件现在都在 Git 仓库中
- ✅ 文档、脚本、代码统一管理
- ✅ 便于分享和部署

### 2. 结构清晰
- ✅ 脚本集中在 `scripts/` 目录
- ✅ 文档集中在 `docs/` 目录
- ✅ 核心代码在 `client/` 和 `server/`
- ✅ 职责分明，易于维护

### 3. 使用便捷
- ✅ 根目录提供 `start.sh` 和 `stop.sh` 快捷入口
- ✅ 所有路径引用已更新，无需修改使用习惯
- ✅ 文档完善，易于上手

### 4. 可维护性提升
- ✅ 新增 `PROJECT_STRUCTURE.md` 说明结构
- ✅ 新增 `README.md` 提供快速入门
- ✅ 保留所有修复记录在 `docs/fixes/`

## 📝 注意事项

### 1. 外层目录
`/home/lyanta/secureChat/` 现在只是一个容器目录，里面只有 `secure-chat-system/` 项目

### 2. Git 仓库位置
Git 仓库在 `secure-chat-system/.git`，这是正确的项目根目录

### 3. 启动命令
建议使用：
```bash
cd /home/lyanta/secureChat/secure-chat-system
./start.sh
```

### 4. PID 文件
`.server.pid` 和 `.client.pid` 会在项目根目录生成，已添加到 `.gitignore`

## 🔄 后续建议

1. **考虑移除外层目录**
   - 可以考虑将 `secure-chat-system` 直接作为项目目录
   - 或者重命名为更简洁的名称

2. **持续维护文档**
   - 新功能添加时更新 `README.md`
   - 问题修复时记录到 `docs/fixes/`

3. **版本管理**
   - 定期提交 Git
   - 使用标签标记重要版本

## ✨ 完成状态

- ✅ 目录结构重组
- ✅ 脚本路径更新
- ✅ Git 配置完善
- ✅ 文档创建和整理
- ✅ 启动入口脚本
- ✅ 所有功能测试通过

**项目架构整理完成！** 🎉

